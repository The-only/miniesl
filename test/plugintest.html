<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>plugintest</title>
    <script src="../src/miniesl.js"></script>
</head>
<body>
    <script>
    define('plugin', ['require', 'exports', 'module'], function (require, exports, module) {

        return {
            normalize: function (name, normalize) {
                var parts = name.split('/');
                return normalize(parts[parts.length-1]);
            },

            load: function (name, require, load, config) {
                require([name], function (value) {
                    load(value);
                });
            }
        };
    });

    define('final', [], function () {
        return {
            say: function (msg) {
                console.log('aa: ' + msg);
            }
        };
    });

    require(['plugin!a/b/c/final'], function (plugin) {
        plugin.say('hello plugin');
    });

    define('css', [], function () {
        return {
            load: function (resourceId, req, load) {
                var link = document.createElement('link');
                link.setAttribute('rel', 'stylesheet');
                link.setAttribute('type', 'text/css');
                link.setAttribute('href', resourceId);

                var parent = document.getElementsByTagName('head')[0]
                    || document.body;
                parent.appendChild(link);

                parent = null;
                link = null;

                load(true);
            }
        }
    });

    require('css!a.css');

    /*
    输出结果：
    aa: hello plugin
    页面背景为#ccc
    */
    </script>
</body>
</html>